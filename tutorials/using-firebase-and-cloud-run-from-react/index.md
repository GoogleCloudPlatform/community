---
title: Use Firebase and Cloud Run from React web application
description: Learn about using Firebase and Cloud Run from React web application
author: enakai00
tags: Firebase, Cloud Run, React, Front-end
date_published: 2022-XX-XX
---

Etsuji Nakai | Solutions Architect | Google

<p style="background-color:#CAFACA;"><i>Contributed by Google employees.</i></p>

This tutorial explains how you can integrate React web application with Firebase
and Cloud Run.

## Objectives

* Build a React web application and deploy it on Firebase hosting.
* Build a backend API service and deploy it on Cloud Run.
* The React application uses Firebase libraries to authenticate users with their Google Account, and call the backend API using an ID token generated by Firebase.
* The backend API service validates the ID token so that only users who logged-in to the application can use the backend API.

## Before you begin

Before you begin this tutorial, you'll need the following:

1.  Create a project in the [Cloud Console](https://console.cloud.google.com/).
2.  [Enable billing](https://cloud.google.com/billing/docs/how-to/modify-project#enable_billing_for_a_project) for your project.
3.  Open [Cloud Shell](https://cloud.google.com/shell/docs/using-cloud-shell).
4.  Set the project ID for the Cloud SDK:

        PROJECT_ID=[YOUR_PROJECT_ID]
        gcloud config set project $PROJECT_ID

5.  Enable APIs:

        gcloud services enable cloudbuild.googleapis.com run.googleapis.com

6.  Clone the repository.

        cd $HOME
        git clone https://github.com/GoogleCloudPlatform/community.git
        REPO=$HOME/community/tutorials/using-firebase-and-cloud-run-from-react

## Add Firebase application and configure Google sign-in provider

1.  Add the project to Firebase from [Firebase Console](https://console.firebase.google.com).
1.  Add Firebase application from **Project Overview** -> **Project settings** menu. (Click the `</>` icon at the bottom of the page.)
    * Specify **App nickname** as you like.
    * Check **Also setup Firebase Hosting for this app**
    * Click **Register App**
    * Take a copy of the Firebase configuration (contents of the variable `const firebaseConfig`) shown on the screen.
    * Click **Next** twice and click **Continue to console** to finish the registration process.
3. Enable the "Google" sign-in provider from **Build** -> **Authentication** menu.
    * Click **Get started**
    * Click **Google** button from **Additional providers**
    * Move **Enable** slider to enable it.
    * Select **Project support email**
    * Click **Save**


### Build and deply the backend API service.

1.  Run the following commands.

        cd $REPO/backend-example
        gcloud builds submit --tag gcr.io/$PROJECT_ID/hello-world-service
        gcloud run deploy hello-world-service \
          --image gcr.io/$PROJECT_ID/hello-world-service \
          --platform=managed --region=us-central1 \
          --allow-unauthenticated

    **Note**: you need a user ID token generated by Firebase to use this backend API.
    As in the following example, arbitrary ID tokens are rejected.

        SERVICE_NAME="hello-world-service"
        SERVICE_URL=$(gcloud run services list --platform managed \
          --format="table[no-heading](URL)" --filter="metadata.name:${SERVICE_NAME}")
        curl -X POST -H "Authorization: Bearer $(gcloud auth print-identity-token)" \
          -H "Content-Type: application/json" \
          -d '{"name":"Google Cloud"}' \
          -s ${SERVICE_URL}/hello-world-service/api/v1/hello

        --- output ---
        Error with authentication: Firebase ID token has incorrect "aud" (audience) claim....

### Build React Application.

1.  Move to the application directory.

        cd $REPO

2.  Overwrite the Firebase configuration `const firebaseConfig` in `src/Firebase.js` with the contents that you copied in the previous step.

        // Replace with your firebase config parameters
        const firebaseConfig = {
          apiKey: "your-API-key",
          authDomain: "example-project.firebaseapp.com",
          projectId: "example-project",
          storageBucket: "example-project.appspot.com",
          messagingSenderId: "000000000000",
          appId: "1:000000000000:web:0000000000000000000000"
        };

3.  Run the following commands.

        nvm install 16.10.0
        yarn install
        yarn build

### Deploy the application on Firebase hosting.

1.  Run the following commands.

        npm install -g firebase-tools
        firebase use $PROJECT_ID
        firebase init hosting

    * Answer the questions as below:

            ? What do you want to use as your public directory? (public) build
            ? Configure as a single-page app (rewrite all urls to /index.html)? N
            ? Set up automatic builds and deploys with GitHub? N
            ? File build/index.html already exists. Overwrite? N

2.  Modify `firebase.json` as below to configure the URL rewrites.

        {
          "hosting": {
            "public": "build",
            "ignore": [
              "firebase.json",
              "**/.*",
              "**/node_modules/**"
            ],
            "rewrites": [
              {
                "source": "/hello-world-service/**",
                "run": {
                  "serviceId": "hello-world-service",
                  "region": "us-central1"
                }
              }
            ]
          }
        }

**[Note]** This configuration is required to avoid the Cross-Origin Resource
Sharing (CORS) restriction. By default, CORS is not allowed on Cloud Run.
It's possible to configure your backend application to allow CORS explicitly.
For example, you can use [Flask-CORS](https://flask-cors.readthedocs.io/en/latest/)
for Flask applications. In this tutorial, you use the URL rewrites feature of
Firebase hosting to avoid the CORS restriction. With this feature, Firebase
hosting can act as a proxy gateway to the backend services running on Cloud Run.

3.  Run the following command.

        firebase deploy

Now you see the **Hosting URL** in the output. Open the URL with your browser to test the application.

![screenshot](/tutorials/using-firebase-and-cloud-run-from-react/doc/img/screenshot.png)

1.  Click **Sign in with Google** and sign in with your Google account. When you
    signed in, you see your profile name and profile photo on the screen.

2.  Click **Get message from the backend API** to call the backend API running
    on Cloud Run. The frontend application use the user ID token generated by
    Firebase to access the backend API. When the backend API return a message,
    you see it on the screen.

